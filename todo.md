# TODO管理ルール

## 基本ルール
- 各機能は `- [ ]` の形式で記述し、完了したら `- [x]` に変更
- 優先度は 🔴高、🟡中、🟢低 で表示
- 各機能には以下の情報を含める：
  - 機能名
  - 優先度
  - 簡潔な説明
  - 関連する技術スタック

## 機能実装リスト

### 認証関連
- [x] 🔴 ユーザー認証機能の実装
  - Clerkを使用した認証システムの構築
  - ログイン/ログアウト機能
  - ユーザープロフィール管理

### ガントチャート機能
- [x] 🔴 ガントチャートの基本機能
  - タスクの作成/編集/削除
  - ドラッグ&ドロップによる日付変更
  - 依存関係の設定

### UI/UX
- [ ] 🟡 レスポンシブデザインの実装
  - モバイル対応
  - タブレット対応
  - デスクトップ対応

### データ管理
- [x] 🟡 データの永続化
  - Prismaを使用したデータベース設計
  - APIエンドポイントの実装
  - データのCRUD操作

## 完了した機能
- [x] 🟢 プロジェクトの初期設定
  - Next.jsプロジェクトの作成
  - 必要なパッケージのインストール
  - 開発環境の構築 
- [x] 🟢 ガントチャートのヘッダー期間がプロジェクトの終了日に追従
  - 対象: `src/components/features/gantt/gantt-chart.tsx`
  - 内容: `endDate` が設定されている場合はそれを表示し、未設定時は開始日から約6ヶ月分にフォールバック
- [x] 🟡 プロジェクトコピー機能の実装
  - 対象: プロジェクト作成フォーム、API、DAL
  - 内容: 既存プロジェクトからタスク、担当者設定、色設定をコピーして新規プロジェクトを作成
  - 機能: コピー元選択UI、トランザクション処理、認証・権限チェック
- [x] 🟡 日本の祝日表示機能の実装
  - 対象: ガントチャートコンポーネント、エクスポート機能
  - 内容: `@holiday-jp/holiday_jp`を使用して日本の祝日を判定し、ガントチャート上で色分け表示
  - 機能: 祝日判定ユーティリティ関数、祝日の背景色表示（ピンク系）、エクスポート時の祝日反映
- [x] 🟡 タスクの2階層化（中項目・小項目）の実装
  - 対象: DBスキーマ、API、ガントチャートUI、タスクフォーム
  - 内容: タスクに親子関係（中項目・小項目）を導入
  - 機能: `parentId`カラム追加、階層表示（インデント）、親タスク選択機能
  - 追加: 中項目の日付（開始・終了）を任意に変更し、バー表示をスキップ
- [x] 🟡 週次エクセルエクスポート対応
  - 対象: `src/app/api/projects/[id]/export/route.ts`
  - 内容: 週単位プロジェクトの場合に1列=1週のヘッダー・バーを出力
  - 仕様: 月曜日始まり、月行の結合、週セルは「d〜」表記、タスクバーは週のセル単位で塗り潰し
- [x] 🟡 ガントチャートの週単位表示の実装
  - 対象: プロジェクト作成フォーム、ガントチャートコンポーネント、API
  - 内容: プロジェクト作成時に日単位/週単位を選択可能にし、ガントチャートのヘッダー・グリッドを切り替え
  - 機能: `timeScale`フィールド対応、週次ヘッダー（年/月/週）、週区切りのグリッド表示
- [x] 🟡 日/週ビュー切替とエクスポート粒度選択
  - 対象: `src/app/gantt/[id]/page.tsx`, `src/components/features/gantt/gantt-chart.tsx`, `src/app/api/projects/[id]/export/route.ts`
  - 内容: プロジェクト表示は常に日単位を初期表示にしつつ、画面上で週表示へ切替可能に変更
  - 機能: ビュー切替セレクト、エクスポート時の単位選択ドロップダウン、APIでの粒度切替処理追加
- [x] 🟢 ビュー切替設定の永続化とエクスポートUI改善
  - 対象: `src/hooks/usePersistentViewScale.ts`, `src/app/gantt/[id]/page.tsx`
  - 内容: プロジェクトごとの表示単位をlocalStorageへ保存し、再訪時も前回と同じビューを自動復元
  - 機能: `usePersistentViewScale`フック、現在ビューでの即時エクスポート/単位別のチェック表示